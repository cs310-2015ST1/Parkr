<!DOCTYPE html>
<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
<!--
<p id="notice"><%= notice %></p>

<h1>Parkr</h1>

<br>
<div style='width: 100%;'>
  <div id="map" style='width: 100%; height: 500px;'></div>
</div>


<script type="text/javascript">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
        markers = handler.addMarkers(<%=raw @hash.to_json %>);
        handler.map.centerOn([49.287902, -123.115866]);
        handler.getMap().setZoom(15);
    });

</script>-->

<html>
<head>
  <h1>Parkr</h1>

  <%= form_tag parking_meters_path, method: :get do %>
      <%= label :location, "Search parking meters near: " %>
      <%= text_field_tag :location, params[:location] %>

      <%= label :distance, "Distance: " %>
      <%= text_field_tag :distance, params[:distance] %>

      <%= submit_tag "Search" %>
  <% end %>
  <%= link_to 'Parking Meters', parking_meters_path %>
  <style>
      #map-canvas {
          width: 100%;
          height: 500px;
      }
  </style>
  <script src="https://maps.googleapis.com/maps/api/js"></script>
  <script>
 /*     var map;
      var markersArray = [];

      function initialize() {
          var mapCanvas = document.getElementById('map-canvas');
          var mapOptions = {
              center: new google.maps.LatLng(49.287902, -123.115866),
              zoom: 15,
              mapTypeId: google.maps.MapTypeId.ROADMAP
          }
          map = new google.maps.Map(mapCanvas, mapOptions)
          markerFromDB();
      }

      function markerFromDB() {
          <#% ParkingMeter.each do |pm| %>
          var lat = <#%= pm.lat %>; # commented out embedded ruby
          var lon = <#%= pm.lon %>;
          addMarker(lat, lon, gbid);
          <#%end%>
      }

      function addMarker(lat, lon) {
          var marker = new google.maps.Marker({
              map: map,
              position: new google.maps.LatLng(lat, lon)
          });
          markersArray.push(marker);
      }*/

      google.maps.event.addDomListener(window, 'load', initialize);

  </script>
</head>
<body>
<div id="map-canvas"></div>
</body>
</html>

